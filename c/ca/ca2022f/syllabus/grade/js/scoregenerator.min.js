!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).ScoreGenerator={})}(this,(function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?c(t):e}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=i(t);if(e){var o=i(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a(this,n)}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){c=!0,i=t},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw i}}}}var p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},h={exports:{}};!function(t,n){var r="__lodash_hash_undefined__",o=9007199254740991,i="[object Arguments]",u="[object Boolean]",c="[object Date]",a="[object Function]",f="[object GeneratorFunction]",s="[object Map]",l="[object Number]",h="[object Object]",y="[object Promise]",v="[object RegExp]",d="[object Set]",b="[object String]",g="[object Symbol]",_="[object WeakMap]",m="[object ArrayBuffer]",w="[object DataView]",j="[object Float32Array]",x="[object Float64Array]",O="[object Int8Array]",k="[object Int16Array]",A="[object Int32Array]",S="[object Uint8Array]",P="[object Uint8ClampedArray]",E="[object Uint16Array]",I="[object Uint32Array]",D=/\w*$/,R=/^\[object .+?Constructor\]$/,T=/^(?:0|[1-9]\d*)$/,L={};L[i]=L["[object Array]"]=L[m]=L[w]=L[u]=L[c]=L[j]=L[x]=L[O]=L[k]=L[A]=L[s]=L[l]=L[h]=L[v]=L[d]=L[b]=L[g]=L[S]=L[P]=L[E]=L[I]=!0,L["[object Error]"]=L[a]=L[_]=!1;var M="object"==e(p)&&p&&p.Object===Object&&p,C="object"==("undefined"==typeof self?"undefined":e(self))&&self&&self.Object===Object&&self,U=M||C||Function("return this")(),X=n&&!n.nodeType&&n,Y=X&&t&&!t.nodeType&&t,F=Y&&Y.exports===X;function $(t,e){return t.set(e[0],e[1]),t}function B(t,e){return t.add(e),t}function H(t,e,n,r){var o=-1,i=t?t.length:0;for(r&&i&&(n=t[++o]);++o<i;)n=e(n,t[o],o,t);return n}function W(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function G(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function N(t,e){return function(n){return t(e(n))}}function z(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var V,q=Array.prototype,J=Function.prototype,K=Object.prototype,Q=U["__core-js_shared__"],Z=(V=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||""))?"Symbol(src)_1."+V:"",tt=J.toString,et=K.hasOwnProperty,nt=K.toString,rt=RegExp("^"+tt.call(et).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ot=F?U.Buffer:void 0,it=U.Symbol,ut=U.Uint8Array,ct=N(Object.getPrototypeOf,Object),at=Object.create,ft=K.propertyIsEnumerable,st=q.splice,lt=Object.getOwnPropertySymbols,pt=ot?ot.isBuffer:void 0,ht=N(Object.keys,Object),yt=Yt(U,"DataView"),vt=Yt(U,"Map"),dt=Yt(U,"Promise"),bt=Yt(U,"Set"),gt=Yt(U,"WeakMap"),_t=Yt(Object,"create"),mt=Wt(yt),wt=Wt(vt),jt=Wt(dt),xt=Wt(bt),Ot=Wt(gt),kt=it?it.prototype:void 0,At=kt?kt.valueOf:void 0;function St(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Pt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Et(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function It(t){this.__data__=new Pt(t)}function Dt(t,n){var r=Nt(t)||function(t){return function(t){return function(t){return!!t&&"object"==e(t)}(t)&&zt(t)}(t)&&et.call(t,"callee")&&(!ft.call(t,"callee")||nt.call(t)==i)}(t)?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],o=r.length,u=!!o;for(var c in t)!n&&!et.call(t,c)||u&&("length"==c||Bt(c,o))||r.push(c);return r}function Rt(t,e,n){var r=t[e];et.call(t,e)&&Gt(r,n)&&(void 0!==n||e in t)||(t[e]=n)}function Tt(t,e){for(var n=t.length;n--;)if(Gt(t[n][0],e))return n;return-1}function Lt(t,e,n,r,o,p,y){var _;if(r&&(_=p?r(t,o,p,y):r(t)),void 0!==_)return _;if(!Jt(t))return t;var R=Nt(t);if(R){if(_=function(t){var e=t.length,n=t.constructor(e);e&&"string"==typeof t[0]&&et.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!e)return function(t,e){var n=-1,r=t.length;e||(e=Array(r));for(;++n<r;)e[n]=t[n];return e}(t,_)}else{var T=$t(t),M=T==a||T==f;if(Vt(t))return function(t,e){if(e)return t.slice();var n=new t.constructor(t.length);return t.copy(n),n}(t,e);if(T==h||T==i||M&&!p){if(W(t))return p?t:{};if(_=function(t){return"function"!=typeof t.constructor||Ht(t)?{}:(e=ct(t),Jt(e)?at(e):{});var e}(M?{}:t),!e)return function(t,e){return Ut(t,Ft(t),e)}(t,function(t,e){return t&&Ut(e,Kt(e),t)}(_,t))}else{if(!L[T])return p?t:{};_=function(t,e,n,r){var o=t.constructor;switch(e){case m:return Ct(t);case u:case c:return new o(+t);case w:return function(t,e){var n=e?Ct(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,r);case j:case x:case O:case k:case A:case S:case P:case E:case I:return function(t,e){var n=e?Ct(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}(t,r);case s:return function(t,e,n){return H(e?n(G(t),!0):G(t),$,new t.constructor)}(t,r,n);case l:case b:return new o(t);case v:return function(t){var e=new t.constructor(t.source,D.exec(t));return e.lastIndex=t.lastIndex,e}(t);case d:return function(t,e,n){return H(e?n(z(t),!0):z(t),B,new t.constructor)}(t,r,n);case g:return i=t,At?Object(At.call(i)):{}}var i}(t,T,Lt,e)}}y||(y=new It);var C=y.get(t);if(C)return C;if(y.set(t,_),!R)var U=n?function(t){return function(t,e,n){var r=e(t);return Nt(t)?r:function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}(r,n(t))}(t,Kt,Ft)}(t):Kt(t);return function(t,e){for(var n=-1,r=t?t.length:0;++n<r&&!1!==e(t[n],n,t););}(U||t,(function(o,i){U&&(o=t[i=o]),Rt(_,i,Lt(o,e,n,r,i,t,y))})),_}function Mt(t){return!(!Jt(t)||(e=t,Z&&Z in e))&&(qt(t)||W(t)?rt:R).test(Wt(t));var e}function Ct(t){var e=new t.constructor(t.byteLength);return new ut(e).set(new ut(t)),e}function Ut(t,e,n,r){n||(n={});for(var o=-1,i=e.length;++o<i;){var u=e[o],c=r?r(n[u],t[u],u,n,t):void 0;Rt(n,u,void 0===c?t[u]:c)}return n}function Xt(t,n){var r,o,i=t.__data__;return("string"==(o=e(r=n))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==r:null===r)?i["string"==typeof n?"string":"hash"]:i.map}function Yt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return Mt(n)?n:void 0}St.prototype.clear=function(){this.__data__=_t?_t(null):{}},St.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},St.prototype.get=function(t){var e=this.__data__;if(_t){var n=e[t];return n===r?void 0:n}return et.call(e,t)?e[t]:void 0},St.prototype.has=function(t){var e=this.__data__;return _t?void 0!==e[t]:et.call(e,t)},St.prototype.set=function(t,e){return this.__data__[t]=_t&&void 0===e?r:e,this},Pt.prototype.clear=function(){this.__data__=[]},Pt.prototype.delete=function(t){var e=this.__data__,n=Tt(e,t);return!(n<0)&&(n==e.length-1?e.pop():st.call(e,n,1),!0)},Pt.prototype.get=function(t){var e=this.__data__,n=Tt(e,t);return n<0?void 0:e[n][1]},Pt.prototype.has=function(t){return Tt(this.__data__,t)>-1},Pt.prototype.set=function(t,e){var n=this.__data__,r=Tt(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},Et.prototype.clear=function(){this.__data__={hash:new St,map:new(vt||Pt),string:new St}},Et.prototype.delete=function(t){return Xt(this,t).delete(t)},Et.prototype.get=function(t){return Xt(this,t).get(t)},Et.prototype.has=function(t){return Xt(this,t).has(t)},Et.prototype.set=function(t,e){return Xt(this,t).set(t,e),this},It.prototype.clear=function(){this.__data__=new Pt},It.prototype.delete=function(t){return this.__data__.delete(t)},It.prototype.get=function(t){return this.__data__.get(t)},It.prototype.has=function(t){return this.__data__.has(t)},It.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Pt){var r=n.__data__;if(!vt||r.length<199)return r.push([t,e]),this;n=this.__data__=new Et(r)}return n.set(t,e),this};var Ft=lt?N(lt,Object):function(){return[]},$t=function(t){return nt.call(t)};function Bt(t,e){return!!(e=null==e?o:e)&&("number"==typeof t||T.test(t))&&t>-1&&t%1==0&&t<e}function Ht(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||K)}function Wt(t){if(null!=t){try{return tt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Gt(t,e){return t===e||t!=t&&e!=e}(yt&&$t(new yt(new ArrayBuffer(1)))!=w||vt&&$t(new vt)!=s||dt&&$t(dt.resolve())!=y||bt&&$t(new bt)!=d||gt&&$t(new gt)!=_)&&($t=function(t){var e=nt.call(t),n=e==h?t.constructor:void 0,r=n?Wt(n):void 0;if(r)switch(r){case mt:return w;case wt:return s;case jt:return y;case xt:return d;case Ot:return _}return e});var Nt=Array.isArray;function zt(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=o}(t.length)&&!qt(t)}var Vt=pt||function(){return!1};function qt(t){var e=Jt(t)?nt.call(t):"";return e==a||e==f}function Jt(t){var n=e(t);return!!t&&("object"==n||"function"==n)}function Kt(t){return zt(t)?Dt(t):function(t){if(!Ht(t))return ht(t);var e=[];for(var n in Object(t))et.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}t.exports=function(t){return Lt(t,!0,!0)}}(h,h.exports);var y,v,d,b,g=h.exports,_=(y=new WeakMap,v=function(t,e){var n=y.get(t);return void 0===n?void 0:n[e]},d=function(t,e,n){var r=y.get(t);if(void 0===r){var o={};return o[e]=n,void y.set(t,o)}r[e]=n,y.set(t,r)},b="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.2/xlsx.full.min.js",function(){function t(e){n(this,t),d(this,"fileID",e),d(this,"corsProxy",null),d(this,"buffer",null),d(this,"workbook",null)}return o(t,[{key:"installLibrary",value:function(t,e){var n;(n=b,new Promise((function(t,e){var r=document.createElement("script");r.src=n,document.body.appendChild(r),r.addEventListener("load",(function(){t()})),r.addEventListener("error",(function(){e()}))}))).then((function(){"function"==typeof t&&t()}),(function(){"function"==typeof e&&e()}))}},{key:"downloadSheet",value:function(t,e){var n=this;(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n="https://docs.google.com/spreadsheets/d/".concat(t,"/export/edit?format=xlsx"),r="string"!=typeof e?n:e+n;return new Promise((function(t,e){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.onload=function(){return t({buffer:function(){return n.response},contentDisposition:function(){return n.getResponseHeader("Content-Disposition")}})},n.onerror=function(){return e(null)},n.open("GET",r),n.send()}))})(v(this,"fileID"),v(this,"corsProxy")).then((function(e){d(n,"buffer",e.buffer()),d(n,"content-disposition",e.contentDisposition()),"function"==typeof t&&t()}),(function(){"function"==typeof e&&e()}))}},{key:"mkSheet",value:function(){var t=v(this,"buffer");if(null===t)return null;var e=XLSX.read(new Uint8Array(t),{type:"array"});return d(this,"workbook",e),!0}},{key:"fileID",get:function(){return v(this,"fileID")}},{key:"contentDisposition",get:function(){return v(this,"content-disposition")}},{key:"corsProxy",set:function(t){d(this,"corsProxy",t)}},{key:"workbook",get:function(){return g(v(this,"workbook"))}},{key:"libInstalled",get:function(){return"undefined"!=typeof XLSX&&"string"==typeof XLSX.version}},{key:"xlsxLib",get:function(){return b},set:function(t){b=t}}]),t}()),m=function(){var t=new WeakMap,e=function(e,n){var r=t.get(e);return void 0===r?void 0:r[n]},r=function(e,n,r){var o=t.get(e);if(void 0===o){var i={};return i[n]=r,void t.set(e,i)}o[n]=r,t.set(e,o)},i=function(t){return{dataURI:function(){return"data:text/csv,"+encodeURIComponent(t)},string:function(){return t},blob:function(){return new Blob([t],{type:"text/csv"})},download:function(t){var e=document.createElement("a");e.download=t+".csv",e.href=URL.createObjectURL(this.blob()),e.click()}}};return function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(s,t);var a=f(s);function s(t){var e;return n(this,s),e=a.call(this,t),r(c(e),"result",null),r(c(e),"hw-count",0),r(c(e),"hw-custom-count",[]),r(c(e),"semester","spring"),r(c(e),"startYear",(new Date).getFullYear()),e}return o(s,[{key:"parseXLSX",value:function(){var t=this.workbook;if(null===t)return console.error("The Workbook has not initalized");var e={};t.SheetNames.forEach((function(n){var r=XLSX.utils.sheet_to_row_object_array(t.Sheets[n]);r.length>0&&(e[n]=r)}));var n=void 0!==e["研究所"]?e["研究所"].sort((function(t,e){return+t["學號"]-+e["學號"]})):[],o=void 0!==e["大學部"]?e["大學部"].sort((function(t,e){return+t["學號"]-+e["學號"]})):[],i=n.concat(o);r(this,"result",i)}},{key:"exportAttendanceSheet",value:function(){var t,n=e(this,"result"),r=e(this,"semester"),o=e(this,"startYear"),u=[],c=function(){for(var t=[],e=n[0],i=0,u=Object.keys(e);i<u.length;i++){var c=u[i].split("/");if(void 0===c.find((function(t){return 0==t.length||isNaN(+t)}))){var a=new Date,f=+c[0],s=+c[1],l="spring"==r?o:f<9?o+1:o;a.setFullYear(l),a.setMonth(f-1),a.setDate(s),t.push(a)}}return t.sort((function(t,e){return t.getTime()-e.getTime()})).map((function(t){return function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},t.getMonth()+1+"/"+t.getDate(),t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate())}))}(),a="學號,姓名,",f=l(c);try{for(f.s();!(t=f.n()).done;){var s=t.value;a=a+s[Object.keys(s)[0]]+","}}catch(t){f.e(t)}finally{f.f()}a=a.substring(0,a.length-1);for(var p=function(t){var e=n[t],r="string"==typeof e["學號"]?e["學號"].trim():void 0,o="string"==typeof e["姓名"]?e["姓名"].trim():void 0,i="".concat(r,",").concat(o,",");c.forEach((function(t){var n=Object.keys(t)[0];i=i+e[n]+","})),u.push(i.substring(0,i.length-1))},h=0;h<n.length;h++)p(h);var y=a+"\n"+u.join("\n");return i(y+"\n")}},{key:"exportScore",value:function(){var t,n=e(this,"result"),r=e(this,"hw-custom-count"),o=function(t,e){return new Array(t).fill(1).map((function(t,n){for(var r=(t+n).toString();r.length<2;)r="0"+r;return e+r})).join(",")},u=[];if(0!=r.length){for(var c=[],a=0;a<r.length;a++)u.push({prefix:r[a].prefix,count:r[a].count,postfix:r[a].postfix,startAt:r[a].startAt}),c.push(o(r[a].count,r[a].prefix));t=c.join(",")}else{var f=e(this,"hw-count");u.push({prefix:"HW",count:f,postfix:"分數",startAt:1}),t=o(f,"HW")}var s,p="學號,姓名,github,".concat(t),h=[],y=l(n);try{for(y.s();!(s=y.n()).done;){for(var v=s.value,d="string"==typeof v["學號"]?v["學號"].trim():void 0,b="string"==typeof v["姓名"]?v["姓名"].trim():void 0,g="string"==typeof v.GitHub?v.GitHub.trim():void 0,_="".concat(d,",").concat(b,",").concat(g,","),m=0;m<u.length;m++)for(var w=u[m],j=w.prefix,x=w.count,O=w.postfix,k=w.startAt;k<=x;k++){for(var A=k.toString();A.length<2;)A="0"+A;void 0!==v[(A=j+A)+O]?_=_+v[A+O].trim()+",":_+=","}h.push(_.substring(0,_.length-1))}}catch(t){y.e(t)}finally{y.f()}var S=p+"\n"+h.join("\n");return i(S+"\n")}},{key:"addHwCustomCount",value:function(t){var n={},o=e(this,"hw-custom-count");return"string"!=typeof t.prefix?console.error("Youe must specify a homework identifier prefix"):void 0!==o.find((function(e){return e.prefix==t.prefix}))?console.error("You must specify an ununsed homework identifier prefix"):(n.prefix=t.prefix,"number"!=typeof t.count?console.error("Youe must specify HW identifier prefix"):(n.count=t.count,"string"==typeof t.postfix?n.postfix=t.postfix:n.postfix="分數","number"==typeof t.startAt&&t.startAt>=0?n.startAt=t.startAt:n.startAt=1,o.push(n),void r(this,"hw-custom-count",o)))}},{key:"hwCount",set:function(t){r(this,"hw-count",t)}},{key:"semester",set:function(t){if(-1==["spring","fall"].indexOf(t))return console.error('Semester must be "spring" or "fall"');r(this,"semester",t)}},{key:"startYear",set:function(t){r(this,"startYear",t)}}]),s}(_)}();t.CSVGenerator=m,t.SheetParser=_,Object.defineProperty(t,"__esModule",{value:!0})}));
